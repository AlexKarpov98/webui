<div fxLayout="column" id="entity-table-component" class="material mat-card mat-card-table">

  <!-- INSERT DYNAMIC CARDHEADER HERE -->
  <!--<div class="invisible" id="cardHeaderContainer" *ngIf="conf.cardHeaderComponent">
    <ng-template dynamicComponent [component]="conf.cardHeaderComponent" [config]="" [parent]="this"></ng-template>
    </div>-->

  <!-- BATCH OPERATIONS START -->
  <div fxLayout="row wrap" fxLayoutAlign="start center" class="multiActionsButton fn-toolbar"
    [ngClass]="{'icons-only': multiActionsIconsOnly}" *ngIf="conf && selection.selected.length > 0"
    [style.display]="selection.selected.length > 0 ? 'block' : 'none'">
    <div fxFlex="100%">
      <div class="multiactions-title" *ngIf="conf.multiActions.length > 0 && !multiActionsIconsOnly">
        <strong>{{"Batch Operations" | translate}}</strong>
      </div>
      <!-- -->
      <div *ngIf="conf.multiActions && conf.multiActions.length > 0" fxLayout="row wrap" fxLayoutGap="16px">
        <span *ngFor="let maction of conf.multiActions" ix-auto ix-auto-type="button" ix-auto-identifier="{{maction?.id}}">
          <!-- DEFAULT -->
          <ng-container *ngIf="!multiActionsIconsOnly">
            <button id="{{ maction?.id }}" mat-button *ngIf="maction.enable" (click)="maction.onClick(this.selection.selected);">
              <mat-icon>{{ maction?.icon }}</mat-icon>&nbsp;<span>{{maction?.label | translate}}</span>
            </button>
          </ng-container>

          <!-- ICONS ONLY -->
          <ng-container *ngIf="multiActionsIconsOnly">
            <button id="{{ maction?.id }}" mat-button matTooltip="{{ maction?.label  | translate }}"
              [matTooltipPosition]=maction?.ttpos *ngIf="maction.enable" (click)="maction.onClick(this.selection.selected);">
              <mat-icon>{{ maction?.icon }}</mat-icon>
            </button>
          </ng-container>

        </span> &nbsp;
      </div>

      <div *ngIf="!conf.multiActions || conf.multiActions.length == 0">
        <span ix-auto ix-auto-type="button" ix-auto-identifier="mdelete">
          <!-- With Labels -->
          <ng-container>
            <button mat-button (click)="doMultiDelete(this.selection.selected);">
              <mat-icon>delete</mat-icon><br><span>{{"Delete" | translate}}</span>
            </button>
          </ng-container>

          <!-- Without Labels -->
          <ng-container>
            <button (click)="doMultiDelete(this.selection.selected);" mat-button
              matTooltip="{{ 'Delete selections'  | translate }}" matTooltipPosition="below">
              <mat-icon>delete</mat-icon>
            </button>
          </ng-container>
        </span >
      </div>

    </div>
  </div>
  <!-- BATCH OPERATIONS END -->

  <div *ngIf="2+2==5" #entityTable></div>

  <table *ngIf="conf && displayedColumns && displayedColumns.length > 0 && currentRows" mat-table [dataSource]="currentRows" #newEntityTable>
    <ng-container *ngFor="let column of columnsToString(currentColumns, 'prop'); let i = index;">

      <ng-container *ngIf="column !== 'action' && column !== 'multiselect'" matColumnDef="{{column}}">
        <th mat-header-cell *matHeaderCellDef>{{currentColumns[i].name}}</th>
        <td mat-cell *matCellDef="let element">{{element[column]}}</td>
      </ng-container>

      <ng-container *ngIf="column == 'action'" matColumnDef="{{column}}">
        <th mat-header-cell *matHeaderCellDef></th>
        <td mat-cell *matCellDef="let element">
          <app-entity-table-actions [entity]="this" [row]="element"></app-entity-table-actions>
        </td>
      </ng-container>

      <ng-container *ngIf="column == 'multiselect'" matColumnDef="{{column}}">
        <th mat-header-cell *matHeaderCellDef>
          <mat-checkbox [indeterminate]="selection.hasValue() && !isAllSelected"
            (change)="$event ? masterToggle() : null"
            [checked]="selection.hasValue() && isAllSelected"
            ix-auto ix-auto-type="checkbox" ix-auto-identifier="title">
          </mat-checkbox>
        </th>
        <td mat-cell *matCellDef="let element">
          <mat-checkbox 
            (click)="$event.stopPropagation()"
            (change)="$event ? selection.toggle(element) : null"
            [checked]="selection.isSelected(element)"
            ix-auto ix-auto-type="checkbox" 
            [ix-auto-identifier]="element[conf.rowIdentifier || 'name']">
          </mat-checkbox>
        </td>
      </ng-container>

    </ng-container>
   
    <tr mat-header-row *matHeaderRowDef="columnsToString(currentColumns, 'prop')"></tr>
    <tr mat-row *matRowDef="let row; columns: columnsToString(currentColumns, 'prop');"></tr>
  </table>
 

</div>
